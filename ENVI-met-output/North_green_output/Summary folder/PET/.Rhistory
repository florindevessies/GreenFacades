library(here) # v. 0.1
library(stringr) # v. 1.2.0
library(purrr) # v. 0.2.3
library(tidyverse)
library(data.table)
library("readxl")
library("writexl")
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PAT_east_plain.xlsx", col_names = TRUE)
library(here) # v. 0.1
library(stringr) # v. 1.2.0
library(purrr) # v. 0.2.3
library(tidyverse)
library(data.table)
library("readxl")
library("writexl")
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PET_east_plain.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PAT_east_green.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PET_east_green.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PAT_west_plain.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PET_west_plain.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
N <- 3
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PAT_west_green.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PET_west_green.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PAT_south_plain.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PET_south_plain.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PAT_south_green.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PET_south_green.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
N <- 3
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PAT_north_plain.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PET_north_plain.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
N <- 3
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PAT_north_green.xlsx", col_names = TRUE)
#FIRST: save script in the same folder as target
wd <- setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
list.files()
here()
# load all files that need to be combined
(allfiles = list.files(pattern = ".XLS",
full.names = TRUE,
recursive = TRUE))
allfiles
# create empty dataframe, loop over list of all files
df <- list()
for (row in allfiles) {
#read all excel files, save them in content
content <-  read_excel(row, col_names = TRUE)
# if the dataframe is empty, fill it up with the first excel sheet
if(is.null(df)){
df <- content
}
# if not empty, add it to the list
else{
df[[row]] <- data.frame(content)
# dataframe <- list(dataframe, content)
}
}
df
# combine all input of the dataframe in one and making averages
combi <- rbindlist(df)[,lapply(.SD,mean), list(Date, Time)]
# write to excel
xls <- write_xlsx(combi, "averages_PET_north_green.xlsx", col_names = TRUE)
